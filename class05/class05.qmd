---
title: "Class 05: Data Visualization with GGPLOT"
author: "Ashley Mazon (PID:A17478903)"
format: pdf
---

Today we are exploring the **ggplot** package and how to make nice figures in R. 

There are lots of ways to make figures and plot in R. These include: 

- so called "base" R 
- and add on packages like **ggplot2**

Here is a simple "base" R plot. 

```{r}
head(cars)
```

We can simply pass this to the `plot()` function

```{r}
plot(cars)
```

> Key point: Base R is quick but not so nice looking in some folks eyes

Let's see how we can plot this with **ggplot2**...

1st I would need to install this add-on package. For this we use the `install.packages()` function - **WE DO THIS IN THE CONSOLE**. This is a one time only deal 

2nd We need to load the package with `library()` function everytime we want to use it. 

```{r}
library(ggplot2) 
ggplot(cars)
```

Every ggplot is composed of at least 3 layers: 

- **data** (i.e a data.frame with the things you want to plot)
- aesthetics **aes()** that map th ecoumns of data to you plot features (i.e aesthetics)
- geoms like **geom_point** that srt how the plot appears 

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_bar()
```
> Key Point: For simple "canned" graphs base R is quicker but as things get more custom and elaborate then ggplot wins out... 

Let's add more layers to our ggplot

Add a line showing the relationship between x and y 
Add a title 
Add custom axis labels "Speed(MPH)" and "Distance(ft)" 
Change the theme...

```{r}
ggplot(cars)+ 
  aes(x=speed, y=dist)+ 
  labs(title= "Silly plot of Speed vs Stoping distance", x="Speed (MPH)", y="Distance(ft)")+
  theme_bw()+ 
  geom_col()
 
```

## Going Further 

Read some gene expression data

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

> Q1. How many genes are in this dataset?
```{r}
nrow(genes)
```

> Q2. How many columns are there?
```{r}
ncol(genes)
```

> Q3. How many upregulated genes are there?
```{r}
sum(genes$State == "up")
table(genes$State)
```

> Q4. What fraction of the total genes is unregulated?
```{r}
round( table(genes$State)/nrow(genes) * 100, 2 )
```

```{r}
p <- ggplot(genes) + 
  aes(x=Condition1, y=Condition2, col=State)+
  geom_point()+ 
  scale_colour_manual( values=c("pink","lightblue","orange") )+ 
  labs(title= "Gene Expression Changes Upon Drug Treatment", x="Control (no drug)", y= "Drug Treatment")+ 
  theme_bw()
p

```


## More Plotting 

Read in the gapminder dataset 

```{r}
library (gapminder)
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```


>Q4. How many different country values are in this dataset?

```{r}
nrow(gapminder)
```
```{r}
length(table(gapminder$country))
```
> Q5. How many dfferent continent values are in this dataset?
```{r}
unique(gapminder$continent)
```

```{r}
ggplot(gapminder)+
  aes(gdpPercap, lifeExp, col=continent)+
  geom_col()
```

I can use the **ggrepel** package to make more sensible labels here 


```{r}
library(ggrepel)
ggplot(gapminder)+
  aes(gdpPercap, lifeExp, col=continent, label=country)+
  geom_point()+
  geom_text_repel()
  
```


```{r}
ggplot(gapminder)+
  aes(gdpPercap, lifeExp, col=continent, label=country)+
  geom_point()+
  facet_wrap(~continent)
```

The main advantages of ggplot vs Base R plots: 

- Consistency: ggplot2 uses a unified grammar for building plots, so you specify data, aesthetics, and geometric layers in a consistent way for all plot types. Base R requires different functions and arguments for each plot type, which can be less intuitive and harder to remember 

- Layering: ggplot2 lets you build plots by adding layers (e.g., points, lines, labels) with the + operator, making complex plots easier to construct and modify. Base R plots require manual additions and can be more cumbersome for multi-layered figures 

- Defaults and Appearance: ggplot2 produces attractive, publication-quality graphics by default, while Base R plots often need extensive tweaking to look polished 

- Customization: ggplot2 makes it easier to customize aesthetics (color, shape, size, etc.) and add features like legends, themes, and annotations. Base R offers fine control but can be fiddly and time-consuming for newcomers 

- Data Handling: ggplot2 works directly with data frames and can map multiple variables to different aesthetics in a single call. Base R often requires manual data manipulation before plotting 
