---
title:  "Class 09: Structural Bioinformatics (pt. 1)"
author: "Ashley Mazon (PID: A17478903)" 
format: pdf    
toc: TRUE
---  

## PDB Data Base

Download a CSV file from the PDB site (accessible from :Analyze" > "PDB Statistics" > "by Experimental Method and Molecular Type"). 

```{r}
library(readr)
stats <- read.csv("Data Export Summary.csv")
head(stats)
```

```{r}
stats$Total 
```

if these were characters then use the following code

```{r}
stats$Total <- as.numeric(gsub(",", "", stats$Total))
n.total <- sum(stats$Total)
n.total
```

> Q1. What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy. Give your answer two significant figures.

```{r}
stats$X.ray <- as.numeric(gsub(",", "", stats$X.ray))
n.xray <- sum(stats$X.ray)
percent_xray <- n.xray/n.total * 100
percent_xray <- signif(percent_xray, 2)
percent_xray
```

There are `percent_xray` percent X ray strcutures in the PDB.

```{r}
stats$EM <- as.numeric(gsub(",", "", stats$EM))
n.em <- sum(stats$EM)
percent_em <- n.em/n.total * 100
percent_em <- signif(percent_em, 2)
percent_em
```
There are `percent_em` percent EM structures in the PDB.


> Q2. What proportion of structures in the PDB are protein?

```{r}
round( stats$Total[1]/n.total * 100, 2)
```

## Exploring PDB Structures 

> Q3. Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

There are over 100 HIV-protease strcutures in the current PDB. 

Package for structural bioinformatics 

```{r}
library(bio3d)

hiv <- read.pdb("1hsg") 
hiv 
```

> Q7: How many amino acid residues are there in this pdb object? 

There are 196 amino acid residues in this PDB object. 

> Q8: Name one of the two non-protein residues? 

Water is a non-protien residue. 

> Q9: How many protein chains are in this structure? 

There are 2 protien chains in this structure. 


Let's first use the Mol* viewer to explore this structure 

![My first view of HIV-Pr](1HSG.png)


> Q4. Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

The atom that is visualized is the oxygen atom due to the relatively small size of hydrogen. 
  
> Q5. There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have

Water Molecule 308 

> Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.

![](1HSG_conservedwater.png)



## PDB Objects in R 

```{r}
head(hiv$atom)
```

Extract the sequence 
```{r}
pdbseq(hiv)
```
```{r}
chainA_seq <- pdbseq (trim.pdb(hiv, chain = "A"))
```

I can interactively view these PDB objects in R with the new **bio3dview** package. This is not yet on CRAN. 

To install this I can set up **pak** package and use it to install **bio3dview** from GitHub. In my console I first run, 


```{r}
library(bio3dview)

view.pdb(hiv)
```

Change some settings

```{r}
sel <- atom.select (hiv, resno=25)

view.pdb (hiv, highlight = sel, 
          highlight.style = "spacefill",
          colorScheme = "chain", 
          col = c("blue","orange"),
          backgroundColor = "pink")
```

## Predict Protein Flexibility 

We can run a bioinformatics calculation to preduct protein dynamics - i.e. functional motions. 

We will use the `nma()` function: 

```{r}
adk <- read.pdb("6s36")
adk
```

```{r}
m <- nma(adk)
```

Generate a "trajectory" of predicted motion 

```{r}
mktrj(m, file = "ADK_nma.pdb")
```


```{r}
view.nma(m)
```

